var Y=Object.defineProperty;var Z=(i,t,e)=>t in i?Y(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var s=(i,t,e)=>(Z(i,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))h(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const d of o.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&h(d)}).observe(document,{childList:!0,subtree:!0});function e(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function h(n){if(n.ep)return;n.ep=!0;const o=e(n);fetch(n.href,o)}})();const l={CANVAS:document.getElementById("canvas"),GAMOVER:document.getElementById("gamover"),HINT:document.getElementById("hint"),OVERLAY:document.getElementById("overlay"),SCORE:document.getElementById("score-el"),START_BTN:document.getElementById("start-el")};class H{constructor({position:t,velocity:e,ctxRef:h,color:n,width:o=5,height:d=5}){s(this,"position",{x:0,y:0});s(this,"velocity",{x:0,y:0});s(this,"color");s(this,"ctxRef");s(this,"width");s(this,"height");this.ctxRef=h,this.position=t,this.velocity=e,this.color=n,this.width=o,this.height=d}update(){this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.draw()}draw(){this.ctxRef.fillStyle=this.color,this.ctxRef.fillRect(this.position.x,this.position.y,this.width,this.height)}}class A extends H{constructor(e,{fades:h,radius:n}){super(e);s(this,"radius");s(this,"opacity",1);s(this,"fades");this.radius=n,this.fades=h}draw(){this.ctxRef.save(),this.ctxRef.globalAlpha=this.opacity,this.ctxRef.beginPath(),this.ctxRef.arc(this.position.x,this.position.y,this.radius,0,Math.PI*2),this.ctxRef.fillStyle=this.color,this.ctxRef.fill(),this.ctxRef.closePath(),this.ctxRef.restore()}update(){super.update(),this.fades&&(this.opacity-=.02)}}class k{constructor(){s(this,"over",!0);s(this,"active",!1);s(this,"score",0)}start(t){this.active=!0,this.over=!1,this.score=0,l.SCORE.textContent="0",l.OVERLAY.classList.add("hidden"),t()}stop(t){this.active=!1,this.over=!0,l.OVERLAY.classList.remove("hidden"),l.GAMOVER.classList.remove("hidden"),l.HINT.hidden=!0,l.START_BTN.textContent="Another round",t&&t()}}const p=new k,w={ArrowRight:{pressed:!1},ArrowLeft:{pressed:!1},Space:{pressed:!1}},F=()=>Math.floor(Math.random()*750)+500,N=({container:i,ctx:t,object:e,color:h="#fff",count:n=15})=>{for(let o=0;o<n;o++)i.push(new A({ctxRef:t,position:{x:e.position.x+(e.width||0)/2,y:e.position.y+(e.height||0)/2},velocity:{x:(Math.random()-.5)*2,y:(Math.random()-.5)*2},color:h},{radius:Math.random()*3,fades:!0}));return i},W=i=>{const{c:t,color:e="rgba(255, 255, 255, .5)",count:h=50,container:n}=i,o=t.getContext("2d");for(let d=0;d<h;d++)n.push(new A({ctxRef:o,position:{x:Math.random()*t.width,y:Math.random()*t.height},velocity:{x:0,y:.5},color:e},{radius:Math.random()*2}));return n};var E=(i=>(i[i.WIDTH=1024]="WIDTH",i[i.HEIGHT=576]="HEIGHT",i))(E||{}),O=(i=>(i[i.PARTICLES=300]="PARTICLES",i[i.PLAYER_PROJECTILES=5]="PLAYER_PROJECTILES",i))(O||{}),P=(i=>(i[i.SHIP=10]="SHIP",i))(P||{});const I=class{constructor(t,e){s(this,"position",{x:0,y:0});s(this,"velocity",{x:0,y:0});s(this,"width",0);s(this,"height",0);s(this,"image",new Image);s(this,"ctxRef");this.ctxRef=e;const h=new Image;h.src="/img/invader.png",h.onload=()=>{this.image=h,this.width=h.width*I.SCALE,this.height=h.height*I.SCALE,this.position=t}}update(t){this.image&&t&&(this.position.x+=t.x,this.position.y+=t.y,this.draw())}draw(){this.ctxRef.drawImage(this.image,this.position.x,this.position.y,this.width,this.height)}shoot(t){t.push(new H({position:{x:this.position.x+this.width/2,y:this.position.y+this.height},velocity:{x:0,y:5},width:3,height:10,ctxRef:this.ctxRef,color:"#fff"}))}};let L=I;s(L,"SCALE",.25);const u=class{constructor(t){s(this,"position",{x:0,y:0});s(this,"velocity",{x:5,y:0});s(this,"width",0);s(this,"height",0);s(this,"ctxRef");s(this,"invaders",[]);this.ctxRef=t,this.invaders=[];const e=Math.floor(Math.random()*10)+5,h=Math.floor(Math.random()*5)+1;this.width=e*u.CELL_SIZE,this.height=h*u.CELL_SIZE;for(let n=0;n<e;n++)for(let o=0;o<h;o++)this.invaders.push(new L({x:n*u.CELL_SIZE,y:o*u.CELL_SIZE},this.ctxRef))}update(){this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.velocity.y=0,(this.position.x+this.width>=E.WIDTH||this.position.x<=0)&&(this.velocity.x=-this.velocity.x,this.velocity.y=u.CELL_SIZE)}draw(){}};let S=u;s(S,"CELL_SIZE",35);const T=class{constructor(t){s(this,"position",{x:0,y:0});s(this,"velocity",{x:0,y:0});s(this,"image",new Image);s(this,"width",0);s(this,"height",0);s(this,"rotation",0);s(this,"opacity",1);s(this,"ctxRef");this.ctxRef=t;const e=new Image;e.src="/img/player.png",e.onload=()=>{this.image=e,this.width=e.width*T.SCALE,this.height=e.height*T.SCALE,this.position={x:Math.floor(E.WIDTH/2-this.width/2),y:Math.floor(E.HEIGHT-this.height-T.OFFSET)}}}update(){this.image&&(this.position.x+=this.velocity.x,this.draw())}draw(){this.ctxRef.save(),this.ctxRef.globalAlpha=this.opacity,this.ctxRef.translate(this.position.x+this.width/2,this.position.y+this.height/2),this.ctxRef.rotate(this.rotation),this.ctxRef.translate(-this.position.x-this.width/2,-this.position.y-this.height/2),this.ctxRef.drawImage(this.image,this.position.x,this.position.y,this.width,this.height),this.ctxRef.restore()}};let c=T;s(c,"SCALE",.3),s(c,"OFFSET",10),s(c,"SPEED",10),s(c,"ROTATION",.15);const a=l.CANVAS;a.width=E.WIDTH;a.height=E.HEIGHT;const y=a.getContext("2d"),r=new c(y),f=[],g=[],m=[],R=[];W({c:a,count:100,container:m});let v=0,C=F();function B(){if(!p.active&&p.over)return;const i=window.requestAnimationFrame(B);y.fillStyle="#111",y.fillRect(0,0,a.width,a.height),w.ArrowRight.pressed&&r.position.x+r.width<=a.width-c.OFFSET?(r.velocity.x=c.SPEED,r.rotation=c.ROTATION):w.ArrowLeft.pressed&&r.position.x>=c.OFFSET?(r.velocity.x=-c.SPEED,r.rotation=-c.ROTATION):(r.velocity.x=0,r.rotation=0),r.update(),m.forEach((t,e)=>{t.position.y-t.radius>=a.height&&(t.position.x=Math.random()*a.width,t.position.y=-t.radius),t.opacity<=0?setTimeout(()=>m.splice(e,1),0):t.update()}),f.forEach((t,e)=>{t.position.y+t.radius<=0?setTimeout(()=>f.splice(e,1),0):t.update()}),g.forEach((t,e)=>{t.position.y>=a.height?setTimeout(()=>g.splice(e,1),0):t.update(),t.position.y+t.height>=r.position.y&&t.position.x+t.width>=r.position.x&&t.position.x<=r.position.x+r.width&&(setTimeout(()=>g.splice(e,1),0),M(i))}),R.forEach((t,e)=>{t.position.y>=a.height?setTimeout(()=>R.splice(e,1),0):t.update(),t.position.y+t.height>=r.position.y&&r.position.x+r.width>=t.position.x&&t.position.x+t.width>=r.position.x&&M(i),v%100===0&&t.invaders.length&&t.invaders[Math.floor(Math.random()*t.invaders.length)].shoot(g),t.invaders.forEach((h,n)=>{h.update(t.velocity),f.forEach((o,d)=>{o.position.y-o.radius<=h.position.y+h.height&&o.position.x+o.radius>=h.position.x&&o.position.x-o.radius<=h.position.x+h.width&&o.position.y+o.radius>=h.position.y&&setTimeout(()=>{const V=t.invaders.find(x=>x===h),b=f.find(x=>x===o);if(V&&b)if(p.score+=P.SHIP,l.SCORE.textContent=p.score.toString(),t.invaders.splice(n,1),f.splice(d,1),m.length<O.PARTICLES&&N({container:m,ctx:y,object:h,color:"#ffde01"}),t.invaders.length){const[x,G]=[t.invaders[0],t.invaders[t.invaders.length-1]];t.width=G.position.x-x.position.x+h.width,t.position.x=x.position.x}else R.splice(e,1)},0)})})}),v%C===0&&(R.push(new S(y)),C=F(),v=0),v++}const D=(i,t)=>{p.over||(i.code in w&&(w[i.code].pressed=!t),i.code==="Space"&&!t&&f.length<O.PLAYER_PROJECTILES&&f.push(new A({ctxRef:y,position:{x:r.position.x+r.width/2,y:r.position.y},velocity:{x:0,y:-10},color:"red"},{radius:4})))};function M(i){r.opacity=0,p.over=!0,N({container:m,ctx:y,object:r}),setTimeout(()=>{p.stop(()=>{R.length=0,g.length=0,f.length=0,v=0,r.opacity=1,r.position.x=Math.floor(a.width/2-r.width/2),w.ArrowRight.pressed=!1,w.ArrowLeft.pressed=!1,window.cancelAnimationFrame(i)})},2e3)}window.addEventListener("keydown",D);window.addEventListener("keyup",i=>D(i,!0));l.START_BTN&&l.START_BTN.addEventListener("click",()=>p.start(B));
